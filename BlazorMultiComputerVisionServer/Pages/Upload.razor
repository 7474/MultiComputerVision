@page "/upload"

@using BlazorMultiComputerVisionServer.Service
@inject IUploadService UploadService

<h1>Upload</h1>
<InputFile OnChange="HandleFileSelected" />
<p>
    @UploadedUri
    <img src="@UploadedUri" />
</p>

@code {
    System.IO.FileStream SelectedFileStream { set; get; }
    double PercentageProgress { set; get; }
    string UploadedUri { set; get; }

    async Task HandleFileSelected(IFileListEntry[] files)
    {
        // TODO 画像サイズはノーマライズしたい
        // TODO 画像以外はアップロード駄目だろう
        // TODO ディレクトリ指定できた方が管理上良さそう
        foreach (var file in files)
        {
            var blob = await UploadService.UploadFile(file.Data, file.Name, true);
            UploadedUri = blob.Uri.ToString();
        }
    }
}
